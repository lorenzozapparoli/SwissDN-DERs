# Future Deployment and Flexibility of Distributed Energy Resources in the Distribution Grids of Switzerland

This repository contains the codebase used to generate the dataset "Future Deployment and Flexibility of Distributed Energy
Resources in the Distribution Grids of Switzerland", available at https://doi.org/10.5281/zenodo.15056134. It provides detailed Distributed Energy Resource (DER) allocations and load profiles across Swiss medium- and low-voltage distribution grids. The scripts and folder structure included here allow users to replicate the creation of DER profiles and their spatial and temporal integration into Switzerland‚Äôs distribution networks.

Important: This repository does not include the input datasets, intermediate processing results, or output data files. The input data are publicly available, and can be gathered as described in dedicated files in this repository. Intermediate results and outputs can be obtained by running the codes in this repository. Scripts provided here enable users to process the input data and reproduce the final outputs.

## üí°Methodology Overview
The generation of the high-resolution DER dataset follows a two-step process:

- Data Retrieval and Processing:
Input data for DER technologies (PVs, BESSs, EVs, HPs) and non-controllable loads is collected, preprocessed, and temporally standardized. This includes forecasts for 2030, 2040, and 2050.

- Integration into Swiss Distribution Grids:
The processed data is geographically and electrically mapped to detailed distribution grid models of Switzerland, including 879 medium-voltage (MV) and 34,920 low-voltage (LV) grids.

## ‚öôÔ∏è How to Run the Code
- **Download the Repository**: Clone the repository to your local machine:
- **Gather Input Files**: Collect the required input files from the sources described in the related paper. Place these files in the appropriate directories as specified in the folder structure and in the scripts. In case of doubt contact the authors of the paper.
- **Install Dependencies**: Make sure you have **Python 3.11** or later installed. Then, install the required Python packages:
    ```bash
    # Create a new conda environment
    conda env create -f environment.yml
    ```
- **Run the Scripts**: Navigate to the relevant folder and execute the scripts as described in the how_to_run.txt files or the folder-specific instructions below. Please run the scripts in the following folder order: PV -> BESS -> HP -> EV -> LV_basicload -> MV_basicload. Data_checker.py and the scripts in the folders SwissDN_DERs and Plotting_data can be run afterwards.

## üìú Description of Key Files and Folders
### üîå Grids
This folder contains the grid data used in the project. It includes the following subfolders:
- `how_to_populate.txt`: This file contains instructions on how to populate the grid data.
- `LV/`: This folder contains the low-voltage grid data.
- `MV/`: This folder contains the medium-voltage grid data.
- `Additional_files`: This folder contains additional files related to the grid data, including the Voronoi partitioning of MV grids and the municipality boundaries.

Please populate the grid data using the instructions in the `how_to_populate.txt` file before doing anything else. The grid data is used in the allocation scripts in the other folders.
### ‚òÄÔ∏è PV
This folder contains scripts and data related to photovoltaic (PV) allocation.
- `how_to_run.txt`: This file contains instructions on how to run the PV allocation scripts.
- `PV_split.py`: This script splits PV data in municipalities for allocation. It processes the input data and prepares it for allocation to the grids.
- `PV_allocation_LV.py`: This script allocates PVs to the LV grids.
- `PV_allocation_MV.py`: This script allocates PVs to the MV grids.
- `Final_results_generator.py`: This script generates the final results for PV allocation, generating the 2030, 2040, 2050 projections.
- `PV_input/`: This folder contains the input data for PV allocation. Refer to the scripts and the `how_to_run.txt` for details on the required input files, and their format.
- `PV_output/`: This folder contains the output data generated by the PV allocator. Refer to the scripts and the `how_to_run.txt` for details on the output files, and their format.
### üîã BESS
This folder contains scripts related to Battery Energy Storage Systems allocation.
- `how_to_run.txt`: This file contains instructions on how to run the BESS allocation scripts.
- `BESS_allocator.py`: This script allocates BESSs to the MV grids based on the input data gatered form the `PV` folder. To run this script, be sure to have run the PV allocation scripts first.
- `Output/`: This folder contains the output data generated by the BESS allocator. It will be populated running the script `BESS_allocator.py`.
### üî• HP
This folder contains scripts and data related to Heat Pump allocation.
- `how_to_run.txt`: This file contains instructions on how to run the heat pump allocation scripts.
- `raw_data_processor_parallelized.py`: This script processes buildings data for heat pump allocation in a parallelized fashion to reduce computational time.
- `HP_building_split.py`: This script splits buildings in municipalities for heat pump allocation. Be sure to run the script `raw_data_processor_parallelized.py` before running this script.
- `HP_allocation_LV.py`: This script allocates heat pumps to the LV grids. Be sure to run the script `HP_building_split.py` before running this script.
- `HP_allocation_MV.py`: This script allocates heat pumps to the MV grids. Be sure to run the script `HP_allocation_LV.py` before running this script.
- `Final_results_generator.py`: This script generates the final results for heat pump allocation, generating the 2030, 2040, 2050 projections. Be sure to run the script `HP_allocation_MV.py` before running this script.
- `HP_input/`: This folder contains the input data for heat pump allocation. Refer to the scripts and the `how_to_run.txt` for details on the required input files, and their format.
- `HP_output/`: This folder contains the output data generated by the heat pump allocator. Refer to the scripts and the `how_to_run.txt` for details on the output files, and their format.
### üöò EV
This folder contains scripts and data related to Electric Vehicles allocation.
- `how_to_run.txt`: This file contains instructions on how to run the electric vehicles allocation scripts.
- `EV_allocator.py`: This script calculates the percentage of EVs in the LV grids.
- `EV_input/`: This folder contains the input data for electric vehicles allocation. Refer to the scripts and the `how_to_run.txt` for details on the required input files, and their format.
- `EV_output/`: This folder contains the output data generated by the electric vehicles allocator. Refer to the scripts and the `how_to_run.txt` for details on the output files, and their format.
### üè° LV_basicload
This folder contains scripts and data related to low-voltage load profile definition.
- `how_to_run.txt`: This file contains instructions on how to run the low-voltage basic load allocation scripts.
- `Municpality_profile_generator.py`: This script generates the municipality load profiles from the data in the municipality_profiles folder.
- `LV_basicload_allocation.py`: This script allocates basic load profiles to the LV grids. This adds a new field to the grids in the folder Grids/LV/, stating the commercial and residential share of the load for each LV node.
- `Result_condenser.py`: This script reads the output data from the LV basic load allocation and condenses it into a single file. This file contains the final results for the LV basic load allocation.
- `LV_basicload_input/`: This folder contains the input data for LV basic load allocation. Refer to the scripts and the `how_to_run.txt` for details on the required input files, and their format.
- `municipality_profiles/`: This folder contains the output data generated by the Municpality_profile_generator.py script.
- `LV_basicload_output/`: This folder contains the output data. Refer to the scripts for details on the output files, and their format.
### üè≠ MV_basicload
This folder contains scripts and data related to medium-voltage load profile definition.
- `how_to_run.txt`: This file contains instructions on how to run the medium-voltage basic load allocation scripts.
- `MV_profile_generator.py`: This script generates the MV load profiles from the data in the MV_basicload_input folder.
- `MV_basicload_input/`: This folder contains the input data for MV basic load generation. Refer to the scripts for details on the required input files, and their format.
- `MV_basicload_output/`: This folder contains the output data generated by the MV basic load generator. Refer to the scripts for details on the output files, and their format.
### üìà Plotting_data
This folder contains scripts and data related to plotting and visualization.
- `Grid_plotter.py`: This script generates plots for the grid data.
- `Plotter.py`: This script generates various plots for the project.
-  `nine_zones.geojson`: This file contains the boundaries of municipalities in Switzerland.
- `Other folders`: These folders contain data and figures related to grid data, figures, deployment histograms, Switzerland maps, hourly DER profiles, monthly DER heatmaps, and paper figures.
### üìÅ SwissDN_DERs
This is the output folder of the project. It contains the data used to generate the final results for the project. This is the folder in the Zenodo repository (https://doi.org/10.5281/zenodo.15056134), with the addition of a data checking script. The data is organized into several subfolders:
- `01_PV/`: This folder contains data related to PV allocation.
- `02_BESS/`: This folder contains data related to BESS allocation.
- `03_HP/`: This folder contains data related to heat pump allocation.
- `04_EV/`: This folder contains data related to EV allocation.
- `05_Demand/`: This folder contains data related to demand allocation.
- `06_Grids/`: This folder contains data related to the distribution grids.
- `07_Complementary_data/`: This folder contains complementary data for the project.
- `08_Data_loader.py`: This script provides a data loader for the project. It loads the data from the subfolders and prepares it for analysis.
- `validity_data_consistency.py`: This script checks the validity and consistency of the data, performing the sanity checks presented in the paper.
### ‚òëÔ∏è Data_checker.py
- This script checks the all the data for consistency and correctness beyond the basic checks performed in the script `validity_data_consistency.py`, and presented in the paper. It also reads all the DER data form the single folders, harmonizes the format, and generates the directory `SwissDN_DERs`.
### ‚öôÔ∏è environment.yml
- This file contains the environment configuration for the project, including required packages and dependencies.

## üìÑ License and Citation
This work is released for academic use. This work is licensed under a CC BY 4.0 license. If you use this code or dataset, please cite the associated article(s):
- **DERs**: [to be published]
- **Grids**: Alfredo Oneto, Blazhe Gjorgiev, Filippo Tettamanti, Giovanni Sansavini, Large-scale generation of geo-referenced power distribution grids from open data with load clustering,
Sustainable Energy, Grids and Networks, Volume 42, 2025, 101678, ISSN 2352-4677, https://doi.org/10.1016/j.segan.2025.101678.


## üóÇÔ∏è Directory Structure
The directory structure is organized as follows:
```plaintext
üìÅ Grids/
    ‚îú‚îÄ‚îÄ how_to_populate.txt
    ‚îú‚îÄ‚îÄ LV/
    ‚îú‚îÄ‚îÄ MV/
    ‚îî‚îÄ‚îÄ Additional_files/
    
üìÅ PV/
    ‚îú‚îÄ‚îÄ Final_results_generator.py
    ‚îú‚îÄ‚îÄ PV_allocation_LV.py
    ‚îú‚îÄ‚îÄ PV_allocation_MV.py
    ‚îú‚îÄ‚îÄ PV_input/
    ‚îú‚îÄ‚îÄ PV_output/
    ‚îú‚îÄ‚îÄ PV_split.py
    ‚îî‚îÄ‚îÄ how_to_run.txt

üìÅ BESS/
    ‚îú‚îÄ‚îÄ BESS_allocator.py
    ‚îú‚îÄ‚îÄ how_to_run.txt
    ‚îî‚îÄ‚îÄ Output/

üìÅ HP/
    ‚îú‚îÄ‚îÄ HP_allocation_LV.py
    ‚îú‚îÄ‚îÄ HP_allocation_MV.py
    ‚îú‚îÄ‚îÄ HP_building_split.py
    ‚îú‚îÄ‚îÄ raw_data_processor_parallelized.py
    ‚îú‚îÄ‚îÄ Final_results_generator.py
    ‚îú‚îÄ‚îÄ HP_input/
    ‚îú‚îÄ‚îÄ HP_output/
    ‚îî‚îÄ‚îÄ how_to_run.txt

üìÅ EV/
    ‚îú‚îÄ‚îÄ EV_allocator.py
    ‚îú‚îÄ‚îÄ EV_input/
    ‚îú‚îÄ‚îÄ EV_output/
    ‚îî‚îÄ‚îÄ how_to_run.txt

üìÅ LV_basicload/
    ‚îú‚îÄ‚îÄ LV_basicload_allocation.py
    ‚îú‚îÄ‚îÄ Municpality_profile_generator.py
    ‚îú‚îÄ‚îÄ Result_condenser.py
    ‚îú‚îÄ‚îÄ LV_basicload_input/
    ‚îú‚îÄ‚îÄ municipality_profiles/
    ‚îî‚îÄ‚îÄ LV_basicload_output/

üìÅ MV_basicload/
    ‚îú‚îÄ‚îÄ MV_basicload_input/
    ‚îú‚îÄ‚îÄ MV_basicload_output/
    ‚îî‚îÄ‚îÄ MV_profile_generator.py

üìÅ SwissDN_DERs/
    ‚îú‚îÄ‚îÄ 01_PV/
    ‚îú‚îÄ‚îÄ 02_BESS/
    ‚îú‚îÄ‚îÄ 03_HP/
    ‚îú‚îÄ‚îÄ 04_EV/
    ‚îú‚îÄ‚îÄ 05_Demand/
    ‚îú‚îÄ‚îÄ 06_Grids/
    ‚îú‚îÄ‚îÄ 07_Complementary_data/
    ‚îú‚îÄ‚îÄ 08_Data_loader.py
    ‚îî‚îÄ‚îÄ validity_data_consistency.py

üìÅ Plotting_data/
    ‚îú‚îÄ‚îÄ grid_plotter.py
    ‚îú‚îÄ‚îÄ Plotter.py
    ‚îú‚îÄ‚îÄ nine_zones.geojson
    ‚îú‚îÄ‚îÄ figures/
    ‚îú‚îÄ‚îÄ grid_data/
    ‚îú‚îÄ‚îÄ histograms/
    ‚îú‚îÄ‚îÄ maps/
    ‚îú‚îÄ‚îÄ monthly_heatmaps/
    ‚îî‚îÄ‚îÄ paper_figures/

üìÑ environment.yml
üìÑ Data_checker.py
```
