# Distributed Energy Resources for Swiss Distribution Grids

This repository contains the codebase used to generate the dataset described in [citation], [citation], which provides detailed Distributed Energy Resource (DER) allocations and load profiles across Swiss medium- and low-voltage distribution grids. The scripts and folder structure included here allow users to replicate the creation of DER profiles and their spatial and temporal integration into Switzerland‚Äôs distribution networks.

Important: This repository does not include the input datasets, intermediate processing results, or output data files. These can be obtained as outlined in the corresponding article. Scripts provided here enable users to process the input data and reproduce the final outputs.

## üß† Methodology Overview
The generation of the high-resolution DER dataset follows a two-step process:

- Data Retrieval and Processing
Input data for DER technologies (PVs, BESSs, EVs, HPs) and non-controllable loads is collected, preprocessed, and temporally standardized. This includes forecasts for 2030, 2040, and 2050.

- Integration into Swiss Distribution Grids
The processed data is geographically and electrically mapped to detailed distribution grid models of Switzerland, including 879 medium-voltage (MV) and 34,920 low-voltage (LV) grids.

## ‚öôÔ∏è How to Run the Code
-  **Download the Repository**: Clone the repository to your local machine:
    ```bash
    git clone <repository_url>
    cd <repository_directory>
    ```
- **Gather Input Files**: Collect the required input files from the sources described in the related paper. Place these files in the appropriate directories as specified in the folder structure and in the scripts.  
- **Install Dependencies**: Install the required Python packages:
    ```bash
    # Create a new conda environment
    conda env create -f environment.yml
    # Activate the environment
    conda activate <environment_name>
    ```
- **Run the Scripts**: Navigate to the relevant folder and execute the scripts as described in the how_to_run.txt files or the folder-specific instructions below.

## üìú Description of Key Files and Folders
### PV
This folder contains scripts and data related to photovoltaic (PV) allocation.
- `how_to_run.txt`: This file contains instructions on how to run the PV allocation scripts.
- `PV_split.py`: This script splits PV data in municipalities for allocation. It processes the input data and prepares it for allocation to the grids.
- `PV_allocation_LV.py`: This script allocates PVs to the LV grids.
- `PV_allocation_MV.py`: This script allocates PVs to the MV grids.
- `Final_results_generator.py`: This script generates the final results for PV allocation, generating the 2030, 2040, 2050 projections.
- `data_processing/`: This folder contains auxiliary data for processing PV data. Refer to the scripts for details on the required input files, and their format.
- `PV_input/`: This folder contains the input data for PV allocation. Refer to the scripts for details on the required input files, and their format.
- `PV_output/`: This folder contains the output data generated by the PV allocator. Refer to the scripts for details on the output files, and their format.
### BESS
This folder contains scripts related to Battery Energy Storage Systems allocation.
- `BESS_allocator.py`: This script allocates BESSs to the MV grids based on the input data gatered form the `PV` folder. To run this script, be sure to have run the PV allocation scripts first.
- `Output/`: This folder contains the output data generated by the BESS allocator. It will be populated running the script `BESS_allocator.py`.
### HP
This folder contains scripts and data related to Heat Pump allocation.
- `how_to_run.txt`: This file contains instructions on how to run the heat pump allocation scripts.
- `raw_data_processor_parallelized.py`: This script processes buildings data for heat pump allocation in a parallelized fashion to reduce computational time.
- `HP_building_split.py`: This script splits buildings in municipalities for heat pump allocation. Be sure to run the script `raw_data_processor_parallelized.py` before running this script.
- `HP_allocation_LV.py`: This script allocates heat pumps to the LV grids. Be sure to run the script `HP_building_split.py` before running this script.
- `HP_allocation_MV.py`: This script allocates heat pumps to the MV grids. Be sure to run the script `HP_allocation_LV.py` before running this script.
- `Final_results_generator.py`: This script generates the final results for heat pump allocation, generating the 2030, 2040, 2050 projections. Be sure to run the script `HP_allocation_MV.py` before running this script.
- `HP_input/`: This folder contains the input data for heat pump allocation. Refer to the scripts for details on the required input files, and their format.
- `HP_output/`: This folder contains the output data generated by the heat pump allocator. Refer to the scripts for details on the output files, and their format.
### EV (Alfredo compile this)
This folder contains scripts and data related to Electric Vehicle allocation.
- `EV_percentage_calculation.py`: This script calculates the percentage of EVs in the MV grids.
- `EV_tasks.ipynb`: This Jupyter notebook contains tasks related to EV allocation and analysis.
- `EV_voronoi_data.ipynb`: This Jupyter notebook contains Voronoi partitioning data for EV allocation.
- `EV_Voronoi_partitioning_CH_MV.py`: This script performs Voronoi partitioning for EV allocation in Switzerland's MV grids.
- `municipality_boundary.geojson`: This file contains the boundaries of Swiss municipalities.
- `MV_trafos_voronoi_new.geojson`: This file contains the Voronoi partitioning data for MV transformers.
- `MV_trafo_partitioning.geojson`: This file contains the partitioning data for MV transformers.
### LV_basicload
This folder contains scripts and data related to low-voltage load profile definition.
- `LV_basicload_allocation.py`: This script allocates basic load profiles to the LV grids. This adds a new field to the grids in the folder LV/, stating the commercial and residential share of the load for each LV node.
- `Result_condenser.py`: This script reads the output data from the LV basic load allocation and condenses it into a single file. This file contains the final results for the LV basic load allocation.
- `LV_basicload_input/`: This folder contains the input data for LV basic load allocation. Refer to the scripts for details on the required input files, and their format.
- `LV/`: This folder contains the output data generated by the LV basic load allocator. Refer to the scripts for details on the output files, and their format.
- `LV_basicload_output/`: This folder contains the output data. Refer to the scripts for details on the output files, and their format.
### MV_basicload
This folder contains scripts and data related to medium-voltage load profile definition.
- `MV_profile_generator.py`: This script generates the MV load profiles from the data in the MV_basicload_input folder.
- `MV_basicload_input/`: This folder contains the input data for MV basic load generation. Refer to the scripts for details on the required input files, and their format.
- `MV_basicload_output/`: This folder contains the output data generated by the MV basic load generator. Refer to the scripts for details on the output files, and their format.
### Plotting_data
This folder contains scripts and data related to plotting and visualization.
- `Grid_plotter.py`: This script generates plots for the grid data.
- `Plotter.py`: This script generates various plots for the project.
- nine_zones.geojson: This file contains the boundaries of nine zones in Switzerland.
- `validity_data_consistency.jpynb`: This Jupyter notebook checks the validity and consistency of the data, performing the sanity checks presented in the paper.
- `Other folders`: These folders contain data and figures related to grid data, figures, deployment histograms, Switzerland maps, hourly DER profiles, monthly DER heatmaps, and paper figures.
### SwissDN_DERs
This is the output folder of the project. It contains the data used to generate the final results for the project. The data is organized into several subfolders:
- `01_PV/`: This folder contains data related to PV allocation.
- `02_BESS/`: This folder contains data related to BESS allocation.
- `03_HP/`: This folder contains data related to heat pump allocation.
- `04_EV/`: This folder contains data related to EV allocation.
- `05_Demand/`: This folder contains data related to demand allocation.
- `06_Grids/`: This folder contains data related to the distribution grids.
- `07_Complementary_data/`: This folder contains complementary data for the project.
- `08_Data_loader.py`: This script provides a data loader for the project. It loads the data from the subfolders and prepares it for analysis.
### Data_checker.py
- This script checks the all the data for consistency and correctness beyond the basic checks performed in the Jupyter notebook `validity_data_consistency.ipynb`, and presented in the paper. It also reads all the DER data form the single folders, harmonizes the format, and generates the directory `SwissDN_DERs`.
### environment.yml
- This file contains the environment configuration for the project, including required packages and dependencies.

## üìÑ License and Citation
This work is released for academic use. This work is licensed under a CC BY 4.0 license. If you use this code or dataset, please cite the associated article(s):
- **DERs**: [to be published]
- **Grids**: Alfredo Oneto, Blazhe Gjorgiev, Filippo Tettamanti, Giovanni Sansavini, Large-scale generation of geo-referenced power distribution grids from open data with load clustering,
Sustainable Energy, Grids and Networks, Volume 42, 2025, 101678, ISSN 2352-4677, https://doi.org/10.1016/j.segan.2025.101678.


## üóÇÔ∏è Directory Structure
The directory structure is organized as follows:
```plaintext
üìÅ BESS/
 ‚îú‚îÄ‚îÄ BESS_allocator.py
 ‚îî‚îÄ‚îÄ Output/

üìÅ EV/
 ‚îú‚îÄ‚îÄ EV_percentage_calculation.py
 ‚îú‚îÄ‚îÄ EV_tasks.ipynb
 ‚îú‚îÄ‚îÄ EV_voronoi_data.ipynb
 ‚îú‚îÄ‚îÄ EV_Voronoi_partitioning_CH_MV.py
 ‚îú‚îÄ‚îÄ municipality_boundary.geojson
 ‚îú‚îÄ‚îÄ MV_trafos_voronoi_new.geojson
 ‚îî‚îÄ‚îÄ MV_trafo_partitioning.geojson

üìÅ HP/
 ‚îú‚îÄ‚îÄ Final_results_generator.py
 ‚îú‚îÄ‚îÄ HP_allocation_LV.py
 ‚îú‚îÄ‚îÄ HP_allocation_MV.py
 ‚îú‚îÄ‚îÄ HP_building_split.py
 ‚îú‚îÄ‚îÄ raw_data_processor_parallelized.py
 ‚îú‚îÄ‚îÄ how_to_run.txt
 ‚îú‚îÄ‚îÄ HP_input/
 ‚îî‚îÄ‚îÄ HP_output/

üìÅ LV_basicload/
 ‚îú‚îÄ‚îÄ LV_basicload_allocation.py
 ‚îú‚îÄ‚îÄ Result_condenser.py
 ‚îú‚îÄ‚îÄ LV_basicload_input/
 ‚îú‚îÄ‚îÄ LV_basicload_output/
 ‚îî‚îÄ‚îÄ LV/

üìÅ MV_basicload/
 ‚îú‚îÄ‚îÄ MV_profile_generator.py
 ‚îú‚îÄ‚îÄ MV_basicload_input/
 ‚îî‚îÄ‚îÄ MV_basicload_output/

üìÅ PV/
 ‚îú‚îÄ‚îÄ Final_results_generator.py
 ‚îú‚îÄ‚îÄ PV_allocation_LV.py
 ‚îú‚îÄ‚îÄ PV_allocation_MV.py
 ‚îú‚îÄ‚îÄ PV_split.py
 ‚îú‚îÄ‚îÄ how_to_run.txt
 ‚îú‚îÄ‚îÄ data_processing/
 ‚îú‚îÄ‚îÄ PV_input/
 ‚îî‚îÄ‚îÄ PV_output/

üìÅ SwissDN_DERs/
 ‚îú‚îÄ‚îÄ 01_PV/
 ‚îú‚îÄ‚îÄ 02_BESS/
 ‚îú‚îÄ‚îÄ 03_HP/
 ‚îú‚îÄ‚îÄ 04_EV/
 ‚îú‚îÄ‚îÄ 05_Demand/
 ‚îú‚îÄ‚îÄ 06_Grids/
 ‚îú‚îÄ‚îÄ 07_Complementary_data/
 ‚îî‚îÄ‚îÄ 08_Data_loader.py

üìÅ Plotting_data/
 ‚îú‚îÄ‚îÄ Grid_data/
 ‚îú‚îÄ‚îÄ Grid_figures/
 ‚îú‚îÄ‚îÄ Grid_plotter.py
 ‚îú‚îÄ‚îÄ Deployment_histograms/
 ‚îú‚îÄ‚îÄ Switzerland_maps/
 ‚îú‚îÄ‚îÄ Hourly_DERs_profiles/
 ‚îú‚îÄ‚îÄ Monthly_DERs_heatmap/
 ‚îú‚îÄ‚îÄ Profiles_figure/
 ‚îú‚îÄ‚îÄ Paper_figures/
 ‚îú‚îÄ‚îÄ Plotter.py
 ‚îú‚îÄ‚îÄ nine_zones.geojson

üìÑ environment.yml
üìÑ Data_checker.py
üìÑ .gitignore
```
